<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WiFi QR Code Generator</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f8f8f8; margin: 0; padding: 0; }
        .container { max-width: 400px; margin: 40px auto; background: #fff; padding: 24px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        h2 { text-align: center; }
        label { display: block; margin-top: 16px; }
        input, select { width: 100%; padding: 8px; margin-top: 4px; border-radius: 4px; border: 1px solid #ccc; }
        #qrcode { display: flex; justify-content: center; margin-top: 24px; min-height: 420px; align-items: center; }
        #qrcode canvas { border: 1px solid #ccc; border-radius: 8px; background: #fff; }
        #qrcode img { border: none; border-radius: 0; background: transparent; }
        .logo-bg {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            background: #fff;
            z-index: 1;
        }
        .logo {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            z-index: 2;
        }
        .qr-wrapper { position: relative; display: inline-block; }
    </style>
</head>
<body>
    <div class="container">
        <h2>WiFi QR Code Generator</h2>
        <form id="wifiForm">
            <label>SSID:
                <input type="text" id="ssid" required>
            </label>
            <label>Password:
                <input type="text" id="password">
            </label>
            <label>Encryption:
                <select id="encryption">
                    <option value="WPA">WPA/WPA2</option>
                    <option value="WEP">WEP</option>
                    <option value="nopass">None</option>
                </select>
            </label>
            <button type="submit" style="margin-top:20px;width:100%;padding:10px;">Generate QR</button>
        </form>
        <div id="qrcode"></div>
        <button id="downloadBtn" style="width:100%;padding:10px;margin-top:16px;display:none;">Download QR</button>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <!-- Use qrcodejs for maximum compatibility -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script>
    const wifiForm = document.getElementById('wifiForm');
    const qrcodeDiv = document.getElementById('qrcode');
    const wifiLogo = 'icon.png';  // Changed to PNG file
    const downloadBtn = document.getElementById('downloadBtn');

    function drawLogoOnCanvas(canvas) {
        return new Promise((resolve) => {
            const ctx = canvas.getContext('2d');
            // Draw white background for logo
            ctx.fillStyle = '#fff';
            ctx.fillRect(140, 140, 120, 120);
            
            const logoImg = new Image();
            logoImg.onload = function() {
                ctx.drawImage(logoImg, 150, 150, 100, 100);
                resolve();
            };
            logoImg.src = wifiLogo;
        });
    }

    wifiForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        const ssid = document.getElementById('ssid').value;
        const password = document.getElementById('password').value;
        const encryption = document.getElementById('encryption').value;
        let qrData = `WIFI:T:${encryption};S:${ssid};`;
        if (encryption !== 'nopass') qrData += `P:${password};`;
        qrData += ';';

        qrcodeDiv.innerHTML = '';
        downloadBtn.style.display = 'none';

        const tempDiv = document.createElement('div');
        document.body.appendChild(tempDiv);

        new QRCode(tempDiv, {
            text: qrData,
            width: 400,
            height: 400,
            colorDark: '#222',
            colorLight: '#fff',
            correctLevel: QRCode.CorrectLevel.H
        });

        const qrImg = tempDiv.querySelector('img');
        const qrCanvas = document.createElement('canvas');
        qrCanvas.width = 400;
        qrCanvas.height = 400;
        
        await new Promise(resolve => {
            qrImg.onload = resolve;
        });

        const ctx = qrCanvas.getContext('2d');
        ctx.drawImage(qrImg, 0, 0, 400, 400);
        document.body.removeChild(tempDiv);

        await drawLogoOnCanvas(qrCanvas);
        qrcodeDiv.innerHTML = '';
        qrcodeDiv.appendChild(qrCanvas);
        downloadBtn.style.display = 'block';
    });

    downloadBtn.addEventListener('click', function() {
        const canvas = qrcodeDiv.querySelector('canvas');
        if (!canvas) return;
        const link = document.createElement('a');
        link.download = 'wifi-qr.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
    });
    </script>
</body>
</html>
</html>